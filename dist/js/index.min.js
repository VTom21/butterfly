(()=>{function C(){document.querySelectorAll("break").forEach(e=>{let t=document.createElement("br");e.parentNode?.replaceChild(t,e)})}function L(e=2){document.querySelectorAll("extra-break").forEach(t=>{let r=document.createDocumentFragment();for(let o=0;o<e;o++){let n=document.createElement("br");r.appendChild(n)}t.parentNode?.replaceChild(r,t)})}function T(){document.querySelectorAll("custom-break").forEach(e=>{let t=document.createDocumentFragment(),r=parseInt(e.getAttribute("n")||"0");for(let o=0;o<r;o++){let n=document.createElement("br");t.appendChild(n)}e.parentNode?.replaceChild(t,e)})}function q(){document.querySelectorAll("divider").forEach(e=>{let t=document.createElement("hr");e.parentNode?.replaceChild(t,e)})}function $(){document.querySelectorAll("highlight").forEach(e=>{let t=document.createElement("strong");t.innerHTML=e.innerHTML,e.parentNode?.replaceChild(t,e)})}document.addEventListener("DOMContentLoaded",()=>{C(),L(),T(),q(),$()});var z=document.querySelectorAll("body *"),E=new WeakMap;document.querySelectorAll(".set").forEach(e=>{E.has(e)||E.set(e,{});let t=E.get(e);Array.from(e.attributes).forEach(r=>{let o=r.name,n=r.value;switch(o){case"thickness":e.style.borderWidth=n+"px";break;case"x-mult":t.scaleX=`scaleX(${n})`;break;case"y-mult":t.scaleY=`scaleY(${n})`;break;case"z-mult":t.scaleZ=`scaleZ(${n})`;break;case"mult":t.scale=`scale(${n})`;break;case"turn":t.rotate=`rotate(${n}deg)`;break;case"x-turn":t.rotate=`rotateX(${n}deg)`;break;case"y-turn":t.rotate=`rotateY(${n}deg)`;break;case"z-turn":t.rotate=`rotateZ(${n}deg)`;break;case"pointer":let a={hand:"pointer",grab:"grab",cross:"crosshair",move:"move",script:"text",idle:"wait",basic:"default",abort:"not-allowed",query:"help",magnify_in:"zoom-in",magnify_out:"zoom-out",disabled:"none"};e.style.cursor=a[n]||n;break;case"blur":e.style.filter=`blur(${n})`;break;case"grayscale":e.style.filter=`grayscale(${n})`;break;case"light":e.style.filter=`brightness(${n})`;break;case"contrast":e.style.filter=`contrast(${n})`;break}}),e.style.transform=Object.values(t).join(" ")});document.querySelectorAll(".rainbow").forEach(e=>{let t=e.getAttribute("offset");t&&e.style.setProperty("--offset",t)});var M={"@click":"click","@dbclick":"dblclick","@m-down":"mousedown","@m-move":"mousemove","@m-over":"mouseover","@m-up":"mouseup","@m-out":"mouseout","@m-wheel":"wheel","@scroll":"scroll","@paste":"paste","@copy":"copy","@k-press":"keypress","@k-down":"keydown","@k-up":"keyup","@load":"load","@change":"change","@resize":"resize","@blur":"blur","@submit":"submit","@search":"search","@input":"input","@select":"select","@reset":"reset","@focus":"focus","@drag":"drag","@drag-end":"dragend","@drag-enter":"dragenter","@drag-leave":"dragleave","@drag-over":"dragover","@drag-start":"dragstart"},h={};for(let e in M){let t=M[e];h[t]||(h[t]=[]),h[t].push(e)}Object.keys(h).forEach(e=>{document.addEventListener(e,t=>{let r=t.target;for(;r&&r!==document;){for(let o of h[e]){let n=r.getAttribute(o);if(n){let a=window[n];typeof a=="function"?a.call(r,t):console.warn(`Handler "${n}" for "${o}" is not defined`);return}}r=r.parentElement}})});document.querySelectorAll("[\\@interlude]").forEach(e=>{let t=e.getAttribute("@interlude"),r=parseInt(e.getAttribute("@time"))||1e3,o=window[t];typeof o=="function"&&setInterval(()=>o.call(e),r)});document.querySelectorAll("[\\@halt]").forEach(e=>{let t=e.getAttribute("@halt"),r=parseInt(e.getAttribute("@time"))||1e3,o=window[t];typeof o=="function"&&setTimeout(()=>o.call(e),r)});document.querySelectorAll("[\\@countdown]").forEach(e=>{let t=e.getAttribute("@countdown"),r=window[t],o=parseInt(e.getAttribute("@tick"))||3e3;if(typeof r!="function"){console.warn(`Handler "${t}" for @countdown is not defined`);return}let n=o,a=100,s=e.textContent,c=setInterval(()=>{n-=a;let f=Math.ceil(n/1e3);e.textContent=s.replace("((countdown))",f),n<=0&&(clearInterval(c),e.textContent=s.replace("((countdown))",0),r.call(e))},a)});document.querySelectorAll("form").forEach(e=>{e.querySelectorAll("input, textarea").forEach(t=>{let r=t.getAttribute("@input-min"),o=t.getAttribute("@input-max"),n=r?parseInt(r):null,a=o?parseInt(o):null;t.dataset.validMin=n?"false":"true",t.dataset.validMax=a?"false":"true",t.addEventListener("input",()=>{let s=t.value.length;n&&s<n?t.dataset.validMin="false":t.dataset.validMin="true",a&&s>a?t.dataset.validMax="false":t.dataset.validMax="true"})}),e.addEventListener("submit",t=>{let r=e.querySelector("input[\\@input-min][data-valid-min='false'], textarea[\\@input-min][data-valid-min='false'], input[\\@input-max][data-valid-max='false'], textarea[\\@input-max][data-valid-max='false']");if(r){t.preventDefault();let o=r.getAttribute("@input-min"),n=r.getAttribute("@input-max"),a="Invalid input.";o&&r.dataset.validMin==="false"?a=`Please enter at least ${o} characters`:n&&r.dataset.validMax==="false"&&(a=`Please enter no more than ${n} characters`),alert(a),r.focus()}})});var O={letters:/^[a-zA-Z]+$/,numbers:/^[0-9]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,hex:/^[0-9a-fA-F]+$/,pass_special:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/,pass_simple:/^[\w!@#$%^&*()_+]{6,}$/,date:/^\d{4}-\d{2}-\d{2}$/,time:/^([01]\d|2[0-3]):([0-5]\d)$/,phone:/^\+?[0-9]{7,15}$/};document.querySelectorAll("input[\\@regex], textarea[\\@regex]").forEach(e=>{let t=e.getAttribute("@regex"),r=O[t];if(!r){console.warn(`Unknown @regex type: "${t}"`);return}e.dataset.validRegex="false",e.addEventListener("input",()=>{r.test(e.value)?e.dataset.validRegex="true":e.dataset.validRegex="false"})});document.querySelectorAll("form").forEach(e=>{e.addEventListener("submit",t=>{let r=e.querySelector("input[\\@regex][data-valid-regex='false'], textarea[\\@regex][data-valid-regex='false']");if(r){t.preventDefault();let o=r.getAttribute("@regex");alert(`Please enter valid ${o}`),r.focus()}})});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[\\@toggle]").forEach(e=>{let t=e.getAttribute("@toggle").split(",").map(o=>o.trim()),r=e.getAttribute("@target")?e.getAttribute("@target").split(",").map(o=>o.trim()):[null];e.addEventListener("click",()=>{t.forEach((o,n)=>{let a=r[n]||r[r.length-1];(a?document.querySelectorAll(a):[e]).forEach(c=>{c&&c.classList.toggle(o)})})})})});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[\\@resize]").forEach(e=>{let t=e.getAttribute("@resize");if(!t)return;let[r,o]=t.split(","),n=parseInt(r),a=parseInt(o);isNaN(n)||isNaN(a)||(document.body.style.width=n+"px",document.body.style.height=a+"px",document.documentElement.style.width=n+"px",document.documentElement.style.height=a+"px")})});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[\\@log]").forEach(e=>{let t=e.getAttribute("@log"),r;if(t==="this"?r=e:t==="window"?r=window:t==="document"?r=document:r=document.querySelector(t),!r){console.warn(`@log target "${t}" not found`);return}r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement?console.log(r.value):r instanceof HTMLElement?console.log(r.textContent.trim()):console.log(r)})});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("input[\\@trim], textarea[\\@trim]").forEach(e=>{e.addEventListener("input",()=>{let t=e.selectionStart;e.value=e.value.trim(),e.setSelectionRange(t,t)})})});var k={soft:/[<>]/g,strict:/[<>{}"'`;]/g};document.querySelectorAll("input[\\@sanitize], textarea[\\@sanitize]").forEach(e=>{let t=e.getAttribute("@sanitize")||"soft",r=k[t]||k.soft;e.addEventListener("input",()=>{e.value=e.value.replace(r,"")})});document.querySelectorAll("[\\@show]").forEach(e=>{e.style.visibility="visible"});document.querySelectorAll("[\\@hide]").forEach(e=>{e.style.visibility="hidden"});document.querySelectorAll("[\\@src]").forEach(e=>{let t=e.getAttribute("@src");t&&(e.setAttribute("src",t),e.removeAttribute("@src"))});document.querySelectorAll("[\\@fallback]").forEach(e=>{let t=e.getAttribute("@fallback");t&&(e.setAttribute("alt",t),e.removeAttribute("@fallback"))});document.querySelectorAll("[\\@link]").forEach(e=>{let t=e.getAttribute("@link");t&&(e.setAttribute("href",t),e.removeAttribute("@link"))});document.querySelectorAll("[\\@text]").forEach(e=>{let t=e.getAttribute("@text");t&&(e.innerHTML=t,e.removeAttribute("@text"))});document.querySelectorAll("[\\@placeholder]").forEach(e=>{let t=e.getAttribute("@placeholder");t&&("placeholder"in e?e.placeholder=t:e.setAttribute("placeholder",t),e.removeAttribute("@placeholder"))});document.querySelectorAll("[\\@compute]").forEach(e=>{let t=e.getAttribute("@compute");if(t){try{let o=new Function("Math",`return ${t};`)(Math);e.innerText+=o}catch(r){console.error("Error evaluating @compute:",t,r),e.innerText=""}e.removeAttribute("@compute")}});document.querySelectorAll("[\\@class]").forEach(e=>{let t=e.getAttribute("@class");t&&(e.className=t,e.removeAttribute("@class"))});document.querySelectorAll("[\\@id]").forEach(e=>{let t=e.getAttribute("@id");t&&(e.id=t,e.removeAttribute("@id"))});document.querySelectorAll("[\\@clip]").forEach(e=>{let t=e.getAttribute("\\@clip");e.addEventListener("click",async()=>{let r=e.textContent;if(t)try{r=new Function("Math","el",`return ${t};`)(Math,e)}catch(o){console.error("Error evaluating @clip:",t,o)}try{await navigator.clipboard.writeText(r),console.log("Copied to clipboard:",r)}catch(o){console.error("Clipboard copy failed:",o)}}),e.removeAttribute("@clip")});function D(e=document.body){let t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),r=[];for(;t.nextNode();)r.push(t.currentNode);r.forEach(n=>{let a=n.textContent.trim();if(["@cycle","@endcycle","@stop","@resume"].some(c=>a.startsWith(c))){let c=document.createComment(a);n.parentNode.replaceChild(c,n)}});let o=Array.from(e.querySelectorAll("*")).flatMap(n=>Array.from(n.childNodes));for(let n of o)if(n.nodeType===Node.COMMENT_NODE&&n.textContent.trim().startsWith("@cycle")){let a=n.textContent.match(/@cycle\s+(\w+)\s+in\s+(\w+)/);if(!a)continue;let[s,c,f]=a,i=window[f];if(!i||!Array.isArray(i))continue;let S=n.parentNode,g=[],u=n.nextSibling;for(;u&&!(u.nodeType===Node.COMMENT_NODE&&u.textContent.trim().startsWith("@endcycle"));)g.push(u),u=u.nextSibling;let y=u,A=[];e:for(let l=0;l<i.length;l++){let v=i[l],b=document.createDocumentFragment(),x=!1;for(let d of g){if(d.nodeType===Node.COMMENT_NODE&&d.textContent.trim().startsWith("@resume")){let m=d.textContent.match(/@resume\((.+)\)/)?.[1];if(m)try{if(new Function(c,"index","array","Math",`return ${m};`)(v,l,i,Math)){x=!0;break}}catch(p){console.error("Error in @resume:",m,p)}continue}if(d.nodeType===Node.COMMENT_NODE&&d.textContent.trim().startsWith("@stop")){let m=d.textContent.match(/@stop\((.+)\)/)?.[1];if(m)try{if(new Function(c,"index","array","Math",`return ${m};`)(v,l,i,Math))break e}catch(p){console.error("Error in @stop:",m,p)}continue}let w=d.cloneNode(!0);N(w,c,v,l,i)&&b.appendChild(w)}x||b.hasChildNodes()&&A.push(b)}g.forEach(l=>l.remove()),A.forEach(l=>S.insertBefore(l,y)),n.remove(),y&&y.remove()}}function N(e,t,r,o,n){if(e.nodeType===Node.ELEMENT_NODE&&e.hasAttribute("@if")){let a=e.getAttribute("@if");try{if(!new Function(t,"index","array","Math",`return ${a};`)(r,o,n,Math))return!1}catch(s){return console.error("Error in @if:",a,s),!1}e.removeAttribute("@if")}return e.nodeType===Node.TEXT_NODE?e.textContent=e.textContent.replace(/@\{([^}]+)\}/g,(a,s)=>{try{return new Function(t,"index","array","Math",`return ${s};`)(r,o,n,Math)}catch(c){return console.error("Expression error:",s,c),""}}):e.nodeType===Node.ELEMENT_NODE&&Array.from(e.childNodes).forEach(a=>{N(a,t,r,o,n)}),!0}function _(e=document.body){function t(r){if(r.nodeType!==Node.TEXT_NODE){if(r.innerHTML&&r.innerHTML.includes("@repeat")){let o=/@repeat\((\d+)\)([\s\S]*?)@endrepeat/g,n=r.innerHTML,a;for(;(a=o.exec(n))!==null;){let s=parseInt(a[1],10),c=a[2],f="";for(let i=0;i<s;i++)f+=c.replace(/@{index}/g,i);n=n.replace(a[0],f),o.lastIndex=0}r.innerHTML=n}r.childNodes.forEach(o=>t(o))}}t(e)}document.addEventListener("DOMContentLoaded",()=>D());document.addEventListener("DOMContentLoaded",()=>_());document.querySelectorAll(".dropdown-toggle").forEach(e=>{e.addEventListener("click",t=>{e.parentElement.classList.toggle("show")})});document.addEventListener("click",e=>{document.querySelectorAll(".dropdown").forEach(t=>{t.contains(e.target)||t.classList.remove("show")})});})();
